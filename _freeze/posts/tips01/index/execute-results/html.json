{
  "hash": "c57c3c2edc57dddd24272aebc1a198a0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"論文に載せる記述統計表を作る\"\nauthor: \"azumaya\"\ndate: \"2024/08/23\"\n# date-modified: \"today\"\nformat: html\nimage: images/cover.png\ncategories:\n  - R\n  - Analysis\n  - Tips\n---\n\n\n\n\n## はじめに\n\n記述統計を出力する関数はたくさんあるけれど、どれも少しずつもの足りない。\n\n既存のパッケージに敬意を払ったあと、公式の場で発表できるくらいの記述統計表を出力するための関数を作る。\n\n## 目標\n\n今回はサンプルデータである`iris`を使って、`Species`ごとに4変数の基本統計量を出力する。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n```\n\n\n:::\n:::\n\n\n\n\n目標は、以下の表のように、グループごとの記述統計表を作ること。\n論文の規定という体で大文字小文字の区別や桁数も再現してみたい（右側の相関行列は省略）。\n\n![出典：Hoetker, G. 2006. Do modular products lead to modular organizations? *Strategic Management Journal* 27 (6): 501–518.](images/tab2.png){fig-align=\"center\"}\n\n\n\n## 既存のパッケージ\n\n基本統計量を出してくれる関数として、\n\n- base::summary()\n- summarytools::descr()\n- psych::describeBy()\n\nを確認する。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# パッケージの読み込み\npacman::p_load(tidyverse, summarytools, psych, gt)\n```\n:::\n\n\n\n\n\n### base::summary()\n\nとりあえずの確認には便利だけど、標準偏差とサンプル数がない。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   \n Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  \n 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  \n Median :5.800   Median :3.000   Median :4.350   Median :1.300  \n Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  \n 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  \n Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  \n       Species  \n setosa    :50  \n versicolor:50  \n virginica :50  \n                \n                \n                \n```\n\n\n:::\n:::\n\n\n\n\n`filter()`を使って`Species`ごとに出力することはできる。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>% \n  filter(Species == \"setosa\") %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   \n Min.   :4.300   Min.   :2.300   Min.   :1.000   Min.   :0.100  \n 1st Qu.:4.800   1st Qu.:3.200   1st Qu.:1.400   1st Qu.:0.200  \n Median :5.000   Median :3.400   Median :1.500   Median :0.200  \n Mean   :5.006   Mean   :3.428   Mean   :1.462   Mean   :0.246  \n 3rd Qu.:5.200   3rd Qu.:3.675   3rd Qu.:1.575   3rd Qu.:0.300  \n Max.   :5.800   Max.   :4.400   Max.   :1.900   Max.   :0.600  \n       Species  \n setosa    :50  \n versicolor: 0  \n virginica : 0  \n                \n                \n                \n```\n\n\n:::\n:::\n\n\n\n\n### summarytools::descr()\n\nまずはそのままの`descr()`。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>% \n  descr()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNon-numerical variable(s) ignored: Species\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDescriptive Statistics  \niris  \nN: 150  \n\n                    Petal.Length   Petal.Width   Sepal.Length   Sepal.Width\n----------------- -------------- ------------- -------------- -------------\n             Mean           3.76          1.20           5.84          3.06\n          Std.Dev           1.77          0.76           0.83          0.44\n              Min           1.00          0.10           4.30          2.00\n               Q1           1.60          0.30           5.10          2.80\n           Median           4.35          1.30           5.80          3.00\n               Q3           5.10          1.80           6.40          3.30\n              Max           6.90          2.50           7.90          4.40\n              MAD           1.85          1.04           1.04          0.44\n              IQR           3.50          1.50           1.30          0.50\n               CV           0.47          0.64           0.14          0.14\n         Skewness          -0.27         -0.10           0.31          0.31\n      SE.Skewness           0.20          0.20           0.20          0.20\n         Kurtosis          -1.42         -1.36          -0.61          0.14\n          N.Valid         150.00        150.00         150.00        150.00\n        Pct.Valid         100.00        100.00         100.00        100.00\n```\n\n\n:::\n:::\n\n\n\n\n`group_by()`をかませて、不要な統計量を除くとすっきり、かなり見やすい！\n変数が多すぎないときはこれでも十分かもしれない。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>% \n  group_by(Species) %>%\n  descr(stats = c(\"mean\", \"sd\", \"min\", \"max\")) # 変数の指定はMeanでなくmean\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDescriptive Statistics  \niris  \nGroup: Species = setosa  \nN: 50  \n\n                Petal.Length   Petal.Width   Sepal.Length   Sepal.Width\n------------- -------------- ------------- -------------- -------------\n         Mean           1.46          0.25           5.01          3.43\n      Std.Dev           0.17          0.11           0.35          0.38\n          Min           1.00          0.10           4.30          2.30\n          Max           1.90          0.60           5.80          4.40\n\nGroup: Species = versicolor  \nN: 50  \n\n                Petal.Length   Petal.Width   Sepal.Length   Sepal.Width\n------------- -------------- ------------- -------------- -------------\n         Mean           4.26          1.33           5.94          2.77\n      Std.Dev           0.47          0.20           0.52          0.31\n          Min           3.00          1.00           4.90          2.00\n          Max           5.10          1.80           7.00          3.40\n\nGroup: Species = virginica  \nN: 50  \n\n                Petal.Length   Petal.Width   Sepal.Length   Sepal.Width\n------------- -------------- ------------- -------------- -------------\n         Mean           5.55          2.03           6.59          2.97\n      Std.Dev           0.55          0.27           0.64          0.32\n          Min           4.50          1.40           4.90          2.20\n          Max           6.90          2.50           7.90          3.80\n```\n\n\n:::\n:::\n\n\n\n\nただ、このままだと`gt()`に渡せないのと、統計量と変数の行列を入れ替えるのが手間すぎるので断念。\n\n### psych::describeBy()\n\nまずはそのままの`describe()`。変数が縦にくるタイプ。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>% \n  psych::describe()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             vars   n mean   sd median trimmed  mad min max range  skew\nSepal.Length    1 150 5.84 0.83   5.80    5.81 1.04 4.3 7.9   3.6  0.31\nSepal.Width     2 150 3.06 0.44   3.00    3.04 0.44 2.0 4.4   2.4  0.31\nPetal.Length    3 150 3.76 1.77   4.35    3.76 1.85 1.0 6.9   5.9 -0.27\nPetal.Width     4 150 1.20 0.76   1.30    1.18 1.04 0.1 2.5   2.4 -0.10\nSpecies*        5 150 2.00 0.82   2.00    2.00 1.48 1.0 3.0   2.0  0.00\n             kurtosis   se\nSepal.Length    -0.61 0.07\nSepal.Width      0.14 0.04\nPetal.Length    -1.42 0.14\nPetal.Width     -1.36 0.06\nSpecies*        -1.52 0.07\n```\n\n\n:::\n:::\n\n\n\n\n\n`describeBy()`を使うことで、簡単にやりたいことに近づいた。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>% \n  psych::describeBy(iris$Species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n Descriptive statistics by group \ngroup: setosa\n             vars  n mean   sd median trimmed  mad min max range skew kurtosis\nSepal.Length    1 50 5.01 0.35    5.0    5.00 0.30 4.3 5.8   1.5 0.11    -0.45\nSepal.Width     2 50 3.43 0.38    3.4    3.42 0.37 2.3 4.4   2.1 0.04     0.60\nPetal.Length    3 50 1.46 0.17    1.5    1.46 0.15 1.0 1.9   0.9 0.10     0.65\nPetal.Width     4 50 0.25 0.11    0.2    0.24 0.00 0.1 0.6   0.5 1.18     1.26\nSpecies         5 50 1.00 0.00    1.0    1.00 0.00 1.0 1.0   0.0  NaN      NaN\n               se\nSepal.Length 0.05\nSepal.Width  0.05\nPetal.Length 0.02\nPetal.Width  0.01\nSpecies      0.00\n------------------------------------------------------------ \ngroup: versicolor\n             vars  n mean   sd median trimmed  mad min max range  skew kurtosis\nSepal.Length    1 50 5.94 0.52   5.90    5.94 0.52 4.9 7.0   2.1  0.10    -0.69\nSepal.Width     2 50 2.77 0.31   2.80    2.78 0.30 2.0 3.4   1.4 -0.34    -0.55\nPetal.Length    3 50 4.26 0.47   4.35    4.29 0.52 3.0 5.1   2.1 -0.57    -0.19\nPetal.Width     4 50 1.33 0.20   1.30    1.32 0.22 1.0 1.8   0.8 -0.03    -0.59\nSpecies         5 50 2.00 0.00   2.00    2.00 0.00 2.0 2.0   0.0   NaN      NaN\n               se\nSepal.Length 0.07\nSepal.Width  0.04\nPetal.Length 0.07\nPetal.Width  0.03\nSpecies      0.00\n------------------------------------------------------------ \ngroup: virginica\n             vars  n mean   sd median trimmed  mad min max range  skew kurtosis\nSepal.Length    1 50 6.59 0.64   6.50    6.57 0.59 4.9 7.9   3.0  0.11    -0.20\nSepal.Width     2 50 2.97 0.32   3.00    2.96 0.30 2.2 3.8   1.6  0.34     0.38\nPetal.Length    3 50 5.55 0.55   5.55    5.51 0.67 4.5 6.9   2.4  0.52    -0.37\nPetal.Width     4 50 2.03 0.27   2.00    2.03 0.30 1.4 2.5   1.1 -0.12    -0.75\nSpecies         5 50 3.00 0.00   3.00    3.00 0.00 3.0 3.0   0.0   NaN      NaN\n               se\nSepal.Length 0.09\nSepal.Width  0.05\nPetal.Length 0.08\nPetal.Width  0.04\nSpecies      0.00\n```\n\n\n:::\n:::\n\n\n\n\n不要な列を削除して表を扱いやすくしてみる。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab <- iris %>% \n  describeBy(iris$Species, \n             mat = TRUE # 行列形式で出力\n            ) \n\ntab <- tab[, names(tab) %in% c(\"group1\", \"mean\", \"sd\", \"min\", \"max\")] \ntab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  group1  mean        sd min max\nSepal.Length1     setosa 5.006 0.3524897 4.3 5.8\nSepal.Length2 versicolor 5.936 0.5161711 4.9 7.0\nSepal.Length3  virginica 6.588 0.6358796 4.9 7.9\nSepal.Width1      setosa 3.428 0.3790644 2.3 4.4\nSepal.Width2  versicolor 2.770 0.3137983 2.0 3.4\nSepal.Width3   virginica 2.974 0.3224966 2.2 3.8\nPetal.Length1     setosa 1.462 0.1736640 1.0 1.9\nPetal.Length2 versicolor 4.260 0.4699110 3.0 5.1\nPetal.Length3  virginica 5.552 0.5518947 4.5 6.9\nPetal.Width1      setosa 0.246 0.1053856 0.1 0.6\nPetal.Width2  versicolor 1.326 0.1977527 1.0 1.8\nPetal.Width3   virginica 2.026 0.2746501 1.4 2.5\nSpecies1          setosa 1.000 0.0000000 1.0 1.0\nSpecies2      versicolor 2.000 0.0000000 2.0 2.0\nSpecies3       virginica 3.000 0.0000000 3.0 3.0\n```\n\n\n:::\n:::\n\n\n\n\n`Speceies`の`setosa`だけ取り出して、細部を再現してみようとするけど、`gt()`に渡すと1列目が消えたり面倒になったのでここで撤退。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab %>% \n  filter(group1 == \"setosa\") %>% \n  mutate(Mean = round(mean, 2), \n         S.D. = round(sd, 2),\n         Min. = round(min, 2), # minとmaxは0があって2桁に見えない\n         Max. = round(max, 2)  # 解決法は後述\n         ) %>% \n  select(Mean:Max.) %>%\n  head(4) %>% \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gtmsoitega\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gtmsoitega table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gtmsoitega thead, #gtmsoitega tbody, #gtmsoitega tfoot, #gtmsoitega tr, #gtmsoitega td, #gtmsoitega th {\n  border-style: none;\n}\n\n#gtmsoitega p {\n  margin: 0;\n  padding: 0;\n}\n\n#gtmsoitega .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gtmsoitega .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gtmsoitega .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gtmsoitega .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gtmsoitega .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gtmsoitega .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gtmsoitega .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gtmsoitega .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gtmsoitega .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gtmsoitega .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gtmsoitega .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gtmsoitega .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gtmsoitega .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gtmsoitega .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gtmsoitega .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gtmsoitega .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gtmsoitega .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gtmsoitega .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gtmsoitega .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gtmsoitega .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gtmsoitega .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gtmsoitega .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gtmsoitega .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gtmsoitega .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gtmsoitega .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gtmsoitega .gt_left {\n  text-align: left;\n}\n\n#gtmsoitega .gt_center {\n  text-align: center;\n}\n\n#gtmsoitega .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gtmsoitega .gt_font_normal {\n  font-weight: normal;\n}\n\n#gtmsoitega .gt_font_bold {\n  font-weight: bold;\n}\n\n#gtmsoitega .gt_font_italic {\n  font-style: italic;\n}\n\n#gtmsoitega .gt_super {\n  font-size: 65%;\n}\n\n#gtmsoitega .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gtmsoitega .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gtmsoitega .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gtmsoitega .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gtmsoitega .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gtmsoitega .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gtmsoitega .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#gtmsoitega .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#gtmsoitega div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"S.D.\">S.D.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Min.\">Min.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Max.\">Max.</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Mean\" class=\"gt_row gt_right\">5.01</td>\n<td headers=\"S.D.\" class=\"gt_row gt_right\">0.35</td>\n<td headers=\"Min.\" class=\"gt_row gt_right\">4.3</td>\n<td headers=\"Max.\" class=\"gt_row gt_right\">5.8</td></tr>\n    <tr><td headers=\"Mean\" class=\"gt_row gt_right\">3.43</td>\n<td headers=\"S.D.\" class=\"gt_row gt_right\">0.38</td>\n<td headers=\"Min.\" class=\"gt_row gt_right\">2.3</td>\n<td headers=\"Max.\" class=\"gt_row gt_right\">4.4</td></tr>\n    <tr><td headers=\"Mean\" class=\"gt_row gt_right\">1.46</td>\n<td headers=\"S.D.\" class=\"gt_row gt_right\">0.17</td>\n<td headers=\"Min.\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"Max.\" class=\"gt_row gt_right\">1.9</td></tr>\n    <tr><td headers=\"Mean\" class=\"gt_row gt_right\">0.25</td>\n<td headers=\"S.D.\" class=\"gt_row gt_right\">0.11</td>\n<td headers=\"Min.\" class=\"gt_row gt_right\">0.1</td>\n<td headers=\"Max.\" class=\"gt_row gt_right\">0.6</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n\n## 関数を自作する\n\n論文の表を再現するために`tidyverse::summarise()`と`gt()`を使って関数を作ってみる。\n\nまずは、`across()`を使ってすべての変数の統計量を出す。\nこのタイミングで、基本統計量の厳密な表記も指定しておく。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>%\n  summarise(across(.cols = where(is.numeric), # 数値型のすべての変数について\n                   .fns = list(Mean = ~ mean(.x, na.rm = TRUE), # 今回は欠損値ないけど\n                               S.D. = ~ sd(.x, na.rm = TRUE),\n                               Min. = ~ min(.x, na.rm = TRUE),\n                               Max. = ~ max(.x, na.rm = TRUE)),\n                   .names = \"{col}-{fn}\") # \"列名-関数名\"の形式で列名を作る\n              ) %>% \n  round(2) %>% # 小数点以下2桁に\n  format(nsmall = 2) # 0も表示させて見た目も2桁に\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length-Mean Sepal.Length-S.D. Sepal.Length-Min. Sepal.Length-Max.\n1              5.84              0.83              4.30              7.90\n  Sepal.Width-Mean Sepal.Width-S.D. Sepal.Width-Min. Sepal.Width-Max.\n1             3.06             0.44             2.00             4.40\n  Petal.Length-Mean Petal.Length-S.D. Petal.Length-Min. Petal.Length-Max.\n1              3.76              1.77              1.00              6.90\n  Petal.Width-Mean Petal.Width-S.D. Petal.Width-Min. Petal.Width-Max.\n1             1.20             0.76             0.10             2.50\n```\n\n\n:::\n:::\n\n\n\n`pivot_loner()`で表に。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>%\n  summarise(across(.cols = where(is.numeric), \n                   .fns = list(Mean = ~ mean(.x, na.rm = TRUE), \n                               S.D. = ~ sd(.x, na.rm = TRUE),\n                               Min. = ~ min(.x, na.rm = TRUE),\n                               Max. = ~ max(.x, na.rm = TRUE)),\n                   .names = \"{col}-{fn}\") \n              ) %>% \n  round(2) %>% \n  format(nsmall = 2) %>% \n  pivot_longer(cols = everything(), # 全ての列を縦に\n               names_to = c(\"variable\", \"stat\"), # variableとstatに分ける\n               names_sep = \"-\" # -でわける\n               ) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 16 × 3\n   variable     stat  value   \n   <chr>        <chr> <I<chr>>\n 1 Sepal.Length Mean  5.84    \n 2 Sepal.Length S.D.  0.83    \n 3 Sepal.Length Min.  4.30    \n 4 Sepal.Length Max.  7.90    \n 5 Sepal.Width  Mean  3.06    \n 6 Sepal.Width  S.D.  0.44    \n 7 Sepal.Width  Min.  2.00    \n 8 Sepal.Width  Max.  4.40    \n 9 Petal.Length Mean  3.76    \n10 Petal.Length S.D.  1.77    \n11 Petal.Length Min.  1.00    \n12 Petal.Length Max.  6.90    \n13 Petal.Width  Mean  1.20    \n14 Petal.Width  S.D.  0.76    \n15 Petal.Width  Min.  0.10    \n16 Petal.Width  Max.  2.50    \n```\n\n\n:::\n:::\n\n\n\n`pivot_wider()`で横に。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>%\n  summarise(across(.cols = where(is.numeric), \n                   .fns = list(Mean = ~ mean(.x, na.rm = TRUE), \n                               S.D. = ~ sd(.x, na.rm = TRUE),\n                               Min. = ~ min(.x, na.rm = TRUE),\n                               Max. = ~ max(.x, na.rm = TRUE)),\n                   .names = \"{col}-{fn}\") \n              ) %>% \n  round(2) %>% \n  format(nsmall = 2) %>% \n  pivot_longer(cols = everything(), \n               names_to = c(\"variable\", \"stat\"), \n               names_sep = \"-\" \n               ) %>% \n  pivot_wider(names_from = stat, # statを列に\n              values_from = value # valueの値に\n              ) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  variable     Mean     S.D.     Min.     Max.    \n  <chr>        <I<chr>> <I<chr>> <I<chr>> <I<chr>>\n1 Sepal.Length 5.84     0.83     4.30     7.90    \n2 Sepal.Width  3.06     0.44     2.00     4.40    \n3 Petal.Length 3.76     1.77     1.00     6.90    \n4 Petal.Width  1.20     0.76     0.10     2.50    \n```\n\n\n:::\n:::\n\n\n\n\n`gt()`を使って見た目をより近づけていく。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>%\n  summarise(across(.cols = where(is.numeric), \n                   .fns = list(Mean = ~ mean(.x, na.rm = TRUE), \n                               S.D. = ~ sd(.x, na.rm = TRUE),\n                               Min. = ~ min(.x, na.rm = TRUE),\n                               Max. = ~ max(.x, na.rm = TRUE)),\n                   .names = \"{col}-{fn}\") \n              ) %>% \n  round(2) %>% \n  format(nsmall = 2) %>% \n  pivot_longer(cols = everything(), \n               names_to = c(\"variable\", \"stat\"), \n               names_sep = \"-\" \n               ) %>% \n  pivot_wider(names_from = stat, \n              values_from = value \n              ) %>% \n  cbind(num = c(1:4),.) %>% # 変数番号をつける\n  gt() %>% \n  cols_label(num = \"\",\n             variable = \"\") %>% # 列名を消す\n  tab_header(title = \"グループ名\") %>%  # タイトル\n  tab_options(heading.align = \"left\") %>%   # タイトルを左揃えに\n  tab_footnote(footnote = paste(\"*\",\"サンプル数\", \"observations.\")) # 脚注\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"fdssbabgyr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fdssbabgyr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fdssbabgyr thead, #fdssbabgyr tbody, #fdssbabgyr tfoot, #fdssbabgyr tr, #fdssbabgyr td, #fdssbabgyr th {\n  border-style: none;\n}\n\n#fdssbabgyr p {\n  margin: 0;\n  padding: 0;\n}\n\n#fdssbabgyr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fdssbabgyr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fdssbabgyr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fdssbabgyr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: left;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fdssbabgyr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fdssbabgyr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fdssbabgyr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fdssbabgyr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fdssbabgyr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fdssbabgyr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fdssbabgyr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fdssbabgyr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fdssbabgyr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fdssbabgyr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fdssbabgyr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdssbabgyr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fdssbabgyr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fdssbabgyr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fdssbabgyr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdssbabgyr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fdssbabgyr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdssbabgyr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fdssbabgyr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdssbabgyr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fdssbabgyr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdssbabgyr .gt_left {\n  text-align: left;\n}\n\n#fdssbabgyr .gt_center {\n  text-align: center;\n}\n\n#fdssbabgyr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fdssbabgyr .gt_font_normal {\n  font-weight: normal;\n}\n\n#fdssbabgyr .gt_font_bold {\n  font-weight: bold;\n}\n\n#fdssbabgyr .gt_font_italic {\n  font-style: italic;\n}\n\n#fdssbabgyr .gt_super {\n  font-size: 65%;\n}\n\n#fdssbabgyr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fdssbabgyr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fdssbabgyr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fdssbabgyr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fdssbabgyr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fdssbabgyr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fdssbabgyr .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#fdssbabgyr .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#fdssbabgyr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"6\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>グループ名</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"S.D.\">S.D.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Min.\">Min.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Max.\">Max.</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">1</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Sepal.Length</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">5.84</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.83</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">4.30</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">7.90</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">2</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Sepal.Width</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">3.06</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.44</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">2.00</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">4.40</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">3</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Petal.Length</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">3.76</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">1.77</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">1.00</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">6.90</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">4</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Petal.Width</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">1.20</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.76</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">0.10</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">2.50</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"> * サンプル数 observations.</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n完成直前！グループごとに出力できるように微調整して関数にまとめる。\n\n::: {.callout-tip appearance=\"simple\"}\n`rlang`パッケージの記法、絶賛勉強中です。ムズイ。\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_stats <- function(df, g) { \n  # gをシンボルに変換\n  g <- rlang::enquo(g)\n  \n  # グループごとのサンプル数を計算\n  n <- df %>% \n    filter(Species == !!g) %>% \n    nrow()\n  \n  df %>%\n    filter(Species == !!g) %>% #\n    summarise(across(where(is.numeric), \n                     list(Mean = ~ mean(.x, na.rm = TRUE),\n                          S.D. = ~ sd(.x, na.rm = TRUE),\n                          Min. = ~ min(.x, na.rm = TRUE),\n                          Max. = ~ max(.x, na.rm = TRUE)),\n                     .names = \"{col}-{fn}\")) %>% \n    round(2) %>% \n    format(nsmall = 2) %>% \n    pivot_longer(cols = everything(), \n                 names_to = c(\"variable\", \"stat\"), \n                 names_sep = \"-\") %>% \n    pivot_wider(names_from = stat, \n                values_from = value) %>% \n    cbind(num = c(1:4),.) %>% \n    gt() %>% \n    cols_label(num = \"\",\n               variable = \"\") %>% \n    tab_header(title = rlang::as_name(g)) %>%  # タイトルにグループ名gを指定\n    tab_options(heading.align = \"left\") %>%   \n    tab_footnote(footnote = paste(\"*\",n, \"observations.\")) # サンプル数nをここで使う\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_stats(iris, \"setosa\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"eaotcvjfne\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#eaotcvjfne table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#eaotcvjfne thead, #eaotcvjfne tbody, #eaotcvjfne tfoot, #eaotcvjfne tr, #eaotcvjfne td, #eaotcvjfne th {\n  border-style: none;\n}\n\n#eaotcvjfne p {\n  margin: 0;\n  padding: 0;\n}\n\n#eaotcvjfne .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#eaotcvjfne .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#eaotcvjfne .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#eaotcvjfne .gt_heading {\n  background-color: #FFFFFF;\n  text-align: left;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#eaotcvjfne .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#eaotcvjfne .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#eaotcvjfne .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#eaotcvjfne .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#eaotcvjfne .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#eaotcvjfne .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#eaotcvjfne .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#eaotcvjfne .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#eaotcvjfne .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#eaotcvjfne .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#eaotcvjfne .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eaotcvjfne .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#eaotcvjfne .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#eaotcvjfne .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#eaotcvjfne .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eaotcvjfne .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#eaotcvjfne .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eaotcvjfne .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#eaotcvjfne .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eaotcvjfne .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#eaotcvjfne .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eaotcvjfne .gt_left {\n  text-align: left;\n}\n\n#eaotcvjfne .gt_center {\n  text-align: center;\n}\n\n#eaotcvjfne .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#eaotcvjfne .gt_font_normal {\n  font-weight: normal;\n}\n\n#eaotcvjfne .gt_font_bold {\n  font-weight: bold;\n}\n\n#eaotcvjfne .gt_font_italic {\n  font-style: italic;\n}\n\n#eaotcvjfne .gt_super {\n  font-size: 65%;\n}\n\n#eaotcvjfne .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#eaotcvjfne .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#eaotcvjfne .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#eaotcvjfne .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#eaotcvjfne .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#eaotcvjfne .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#eaotcvjfne .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#eaotcvjfne .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#eaotcvjfne div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"6\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>setosa</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"S.D.\">S.D.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Min.\">Min.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Max.\">Max.</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">1</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Sepal.Length</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">5.01</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.35</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">4.30</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">5.80</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">2</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Sepal.Width</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">3.43</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.38</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">2.30</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">4.40</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">3</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Petal.Length</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">1.46</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.17</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">1.00</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">1.90</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">4</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Petal.Width</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">0.25</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.11</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">0.10</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">0.60</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"> * 50 observations.</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nsummary_stats(iris, \"versicolor\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hppquzcmai\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hppquzcmai table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hppquzcmai thead, #hppquzcmai tbody, #hppquzcmai tfoot, #hppquzcmai tr, #hppquzcmai td, #hppquzcmai th {\n  border-style: none;\n}\n\n#hppquzcmai p {\n  margin: 0;\n  padding: 0;\n}\n\n#hppquzcmai .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hppquzcmai .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hppquzcmai .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hppquzcmai .gt_heading {\n  background-color: #FFFFFF;\n  text-align: left;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hppquzcmai .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hppquzcmai .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hppquzcmai .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hppquzcmai .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hppquzcmai .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hppquzcmai .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hppquzcmai .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hppquzcmai .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hppquzcmai .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hppquzcmai .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hppquzcmai .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hppquzcmai .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hppquzcmai .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hppquzcmai .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hppquzcmai .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hppquzcmai .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hppquzcmai .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hppquzcmai .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hppquzcmai .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hppquzcmai .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hppquzcmai .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hppquzcmai .gt_left {\n  text-align: left;\n}\n\n#hppquzcmai .gt_center {\n  text-align: center;\n}\n\n#hppquzcmai .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hppquzcmai .gt_font_normal {\n  font-weight: normal;\n}\n\n#hppquzcmai .gt_font_bold {\n  font-weight: bold;\n}\n\n#hppquzcmai .gt_font_italic {\n  font-style: italic;\n}\n\n#hppquzcmai .gt_super {\n  font-size: 65%;\n}\n\n#hppquzcmai .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hppquzcmai .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hppquzcmai .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hppquzcmai .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hppquzcmai .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hppquzcmai .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hppquzcmai .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hppquzcmai .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hppquzcmai div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"6\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>versicolor</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"S.D.\">S.D.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Min.\">Min.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Max.\">Max.</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">1</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Sepal.Length</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">5.94</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.52</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">4.90</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">7.00</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">2</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Sepal.Width</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">2.77</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.31</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">2.00</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">3.40</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">3</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Petal.Length</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">4.26</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.47</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">3.00</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">5.10</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">4</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Petal.Width</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">1.33</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.20</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">1.00</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">1.80</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"> * 50 observations.</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nsummary_stats(iris, \"virginica\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"sjsddjbzvy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#sjsddjbzvy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#sjsddjbzvy thead, #sjsddjbzvy tbody, #sjsddjbzvy tfoot, #sjsddjbzvy tr, #sjsddjbzvy td, #sjsddjbzvy th {\n  border-style: none;\n}\n\n#sjsddjbzvy p {\n  margin: 0;\n  padding: 0;\n}\n\n#sjsddjbzvy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#sjsddjbzvy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#sjsddjbzvy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#sjsddjbzvy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: left;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#sjsddjbzvy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#sjsddjbzvy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#sjsddjbzvy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#sjsddjbzvy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#sjsddjbzvy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#sjsddjbzvy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#sjsddjbzvy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#sjsddjbzvy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#sjsddjbzvy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#sjsddjbzvy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#sjsddjbzvy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjsddjbzvy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#sjsddjbzvy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#sjsddjbzvy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#sjsddjbzvy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjsddjbzvy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#sjsddjbzvy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjsddjbzvy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#sjsddjbzvy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjsddjbzvy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#sjsddjbzvy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjsddjbzvy .gt_left {\n  text-align: left;\n}\n\n#sjsddjbzvy .gt_center {\n  text-align: center;\n}\n\n#sjsddjbzvy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#sjsddjbzvy .gt_font_normal {\n  font-weight: normal;\n}\n\n#sjsddjbzvy .gt_font_bold {\n  font-weight: bold;\n}\n\n#sjsddjbzvy .gt_font_italic {\n  font-style: italic;\n}\n\n#sjsddjbzvy .gt_super {\n  font-size: 65%;\n}\n\n#sjsddjbzvy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#sjsddjbzvy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#sjsddjbzvy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#sjsddjbzvy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#sjsddjbzvy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#sjsddjbzvy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#sjsddjbzvy .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#sjsddjbzvy .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#sjsddjbzvy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"6\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>virginica</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"S.D.\">S.D.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Min.\">Min.</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Max.\">Max.</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">1</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Sepal.Length</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">6.59</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.64</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">4.90</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">7.90</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">2</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Sepal.Width</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">2.97</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.32</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">2.20</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">3.80</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">3</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Petal.Length</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">5.55</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.55</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">4.50</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">6.90</td></tr>\n    <tr><td headers=\"num\" class=\"gt_row gt_right\">4</td>\n<td headers=\"variable\" class=\"gt_row gt_left\">Petal.Width</td>\n<td headers=\"Mean\" class=\"gt_row gt_center\">2.03</td>\n<td headers=\"S.D.\" class=\"gt_row gt_center\">0.27</td>\n<td headers=\"Min.\" class=\"gt_row gt_center\">1.40</td>\n<td headers=\"Max.\" class=\"gt_row gt_center\">2.50</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"> * 50 observations.</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\nできた～～～！\n\n\n\n## おわりに\n\nデータフレームを.xlsx出力して、Excelで見た目整えた方が楽なのでは？って思いました（本末転倒）。\n\n`summarytools::descr()`も`psych::describeBy()`も全然使えるけど、やっぱりtidyverseがお気に入りかもしれない。\nR上でここまで再現できるんだという学びになりました。\n\n今後は関数をより気軽に作るために非標準評価 (Non Standard Evaluation: NSE) を勉強していきたいです。\n\n\n## 参考\n\n[gt入門](https://www.jaysong.net/tutorial/R/gt.html)\n\n[雰囲気で理解するtidy evaluation(1): tidy evaluationの導入](https://qiita.com/uri/items/6d5f285280387dff0caa)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}